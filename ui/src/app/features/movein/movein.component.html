<div
  *ngIf="showModal"
  class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"
>
  <div
    class="bg-white rounded-xl shadow-lg w-full max-w-2xl p-6 relative animate-fadeIn"
  >
    <!-- Close button -->
    <button
      (click)="closeModal()"
      class="absolute top-3 right-3 text-gray-600 hover:text-black text-xl"
    >
      ‚úñ
    </button>

    <!-- Modal Title -->
    <h3 class="text-lg font-semibold mb-4">
      {{ isEditing ? '‚úèÔ∏è Update Move-In' : '‚ûï Add New Move-In' }}
    </h3>

  <!-- Move-In Form with Floating Labels -->
    <form
      (ngSubmit)="isEditing ? updateMoveIn() : addMoveIn()"
      #moveInForm="ngForm"
      class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"
    >
      <!-- Full Name -->
      <div class="relative">
        <input
          type="text"
          [(ngModel)]="moveIn.FullName"
          name="FullName"
          required
          placeholder=" "
          class="peer block w-full border border-gray-300 rounded-md px-3 pt-5 pb-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        />
        <label
          class="absolute left-3 top-2 text-gray-400 text-sm peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-blue-500 peer-focus:text-sm transition-all"
        >
          Full Name
        </label>
      </div>

      <!-- Email -->
      <div class="relative">
        <input
          type="email"
          [(ngModel)]="moveIn.Email"
          name="Email"
          required
          placeholder=" "
          class="peer block w-full border border-gray-300 rounded-md px-3 pt-5 pb-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        />
        <label
          class="absolute left-3 top-2 text-gray-400 text-sm peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-blue-500 peer-focus:text-sm transition-all"
        >
          Email
        </label>
      </div>

      <!-- Mobile Number -->
      <div class="relative">
        <input
          type="tel"
          [(ngModel)]="moveIn.Mobile"
          name="Mobile"
          required
          placeholder=" "
          class="peer block w-full border border-gray-300 rounded-md px-3 pt-5 pb-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        />
        <label
          class="absolute left-3 top-2 text-gray-400 text-sm peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-blue-500 peer-focus:text-sm transition-all"
        >
          Mobile Number
        </label>
      </div>

      <!-- Move-In Date -->
      <div class="relative">
        <input
          type="date"
          [(ngModel)]="moveIn.MoveInDate"
          name="MoveInDate"
          required
          placeholder=" "
          class="peer block w-full border border-gray-300 rounded-md px-3 pt-5 pb-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        />
        <label
          class="absolute left-3 top-2 text-gray-400 text-sm peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-blue-500 peer-focus:text-sm transition-all"
        >
          Move-In Date
        </label>
      </div>

      <!-- Building -->
      <div class="relative">
        <select
          [(ngModel)]="moveIn.BuildingId"
          name="BuildingId"
          (change)="onFormBuildingChange()"
          required
          class="peer block w-full border border-gray-300 rounded-md px-3 pt-5 pb-2 focus:outline-none focus:ring-2 focus:ring-blue-400 appearance-none"
        >
          <option value="" disabled selected></option>
          <option *ngFor="let b of buildings" [value]="b.Id">{{ b.BuildingNumber }}</option>
        </select>
        <label
          class="absolute left-3 top-2 text-gray-400 text-sm peer-focus:top-2 peer-focus:text-blue-500 peer-focus:text-sm transition-all"
        >
          Building
        </label>
      </div>

      <!-- Unit -->
      <div class="relative">
        <select
          [(ngModel)]="moveIn.UnitId"
          name="UnitId"
          required
          class="peer block w-full border border-gray-300 rounded-md px-3 pt-5 pb-2 focus:outline-none focus:ring-2 focus:ring-blue-400 appearance-none"
        >
          <option value="" disabled selected></option>
          <option *ngFor="let u of units" [value]="u.Id">{{ u.UnitNumber }}</option>
        </select>
        <label
          class="absolute left-3 top-2 text-gray-400 text-sm peer-focus:top-2 peer-focus:text-blue-500 peer-focus:text-sm transition-all"
        >
          Unit
        </label>
      </div>

      <!-- Submit Button -->
      <div class="col-span-full text-right">
        <button
          type="submit"
          class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
        >
          {{ isEditing ? 'üíæ Update Move-In' : '‚ûï Add Move-In' }}
        </button>
      </div>
    </form>

  </div>
</div>

<div class="p-6 bg-white rounded-xl shadow-md">
  <!-- Header -->
  <div class="mb-4 flex justify-between items-center">
    <h2 class="text-2xl font-bold text-gray-700"> Move-In Records</h2>
  </div>

  <!-- Filters & Search -->
  <div class="flex flex-wrap gap-4 mb-5">
    <!-- Building Filter -->
    
      <!-- Building Filter -->
      <div class="relative">
        <input
          type="text"
          placeholder=" "
          value="303"
          class="peer block w-40 border border-gray-300 rounded-md px-3 pt-5 pb-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        />
        <label
          class="absolute left-3 top-2 text-gray-400 text-sm peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-blue-500 peer-focus:text-sm transition-all"
        >
          Building
        </label>
      </div>

      <!-- Unit Filter -->
      <div class="relative">
        <input
          type="text"
          placeholder=" "
          [(ngModel)]="searchText"
          (ngModelChange)="onSearchChange()"
          class="peer block w-40 border border-gray-300 rounded-md px-3 pt-5 pb-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        />
        <label
          class="absolute left-3 top-2 text-gray-400 text-sm peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-blue-500 peer-focus:text-sm transition-all"
        >
          Unit
        </label>
      </div>
  </div>

  <!-- Move-In Table -->
  <div class="overflow-x-auto">
    <table class="min-w-full border border-gray-200 text-sm">
      <thead class="bg-gray-100 text-gray-700">
        <tr>
          <th class="py-2 px-4 border-b text-left">Bldg. #</th>
          <th class="py-2 px-4 border-b text-left">Unit #</th>
          <th class="py-2 px-4 border-b text-left">Full Name</th>
          <th class="py-2 px-4 border-b text-left">Move-In Date</th>
          <th class="py-2 px-4 border-b text-left">Mobile Number</th>
          <th class="py-2 px-4 border-b text-left">Email</th>
          <th class="py-2 px-4 border-b text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let movein of filteredMoveIns()"
          class="border-b hover:bg-gray-50"
        >
          <td class="py-2 px-4">{{ movein.unit?.building.BuildingNumber || '-' }}</td>
          <td class="py-2 px-4">{{ movein.unit?.UnitNumber || '-' }}</td>
          <td class="py-2 px-4 font-medium">{{ movein.FullName }}</td>
          <td class="py-2 px-4">{{ movein.MoveInDate | date: 'yyyy-MM-dd' }}</td>
          <td class="py-2 px-4">{{ movein.Mobile }}</td>
          <td class="py-2 px-4">{{ movein.Email }}</td>
          <td class="py-2 px-4 text-center">
            <button
              class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 transition"
              (click)="editMoveIn(movein)"
            >
              ‚úèÔ∏è Update
            </button>
          </td>
        </tr>

        <tr *ngIf="filteredMoveIns().length === 0">
        <tr *ngIf="filteredMoveIns().length === 0">
          <td colspan="7" class="text-center py-3 text-gray-500">
            No records found.
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Pagination Controls -->
<div class="flex items-center justify-between mt-4">
  <div>
    Showing page {{ page }} of {{ totalPages }}
    ({{ total }} records)
  </div>
  <div class="flex items-center gap-2">
    <button (click)="onPageChange(page - 1)" [disabled]="page === 1" class="px-3 py-1 rounded border bg-gray-100">Prev</button>
    <span>Page {{ page }}</span>
    <button (click)="onPageChange(page + 1)" [disabled]="page >= totalPages" class="px-3 py-1 rounded border bg-gray-100">Next</button>
    <select [(ngModel)]="pageSize" (change)="onPageSizeChange(pageSize)" class="ml-2 border rounded px-2 py-1">
      <option [value]="5">5</option>
      <option [value]="10">10</option>
      <option [value]="20">20</option>
      <option [value]="50">50</option>
    </select>
    <span>per page</span>
  </div>
</div>