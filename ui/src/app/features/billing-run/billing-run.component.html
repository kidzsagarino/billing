<h1 class="mb-3 text-2xl font-bold">Billing Summary</h1>

<!-- Text Input Group -->
<div class="flex flex-wrap gap-4 mb-3 p-4 bg-white rounded-lg shadow-md">
  <!-- Building Number -->
   
  <div class="flex-1 min-w-[140px] flex flex-col">
     <label class="block text-sm font-semibold mb-1">Building</label>
    <input placeholder="Bldg. #" value="303"
           class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400">
  </div>

  <!-- Unit Number -->
  <div class="flex-1 min-w-[140px] flex flex-col">
     <label class="block text-sm font-semibold mb-1">Unit #</label>
    <input placeholder="Enter Unit #"
    [(ngModel)]="searchTerm"
    (ngModelChange)="search()"
           class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400">
  </div>
</div>

<!-- Dropdowns + Buttons Group -->
<div class="flex flex-wrap justify-center items-center gap-4 mb-3 p-4 bg-white rounded-lg shadow-md">
  <div class="flex flex-wrap gap-4 mb-3">

    <!-- Year Dropdown -->
    <div class="flex-1 min-w-[140px] flex flex-col">
      <select 
        class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        [(ngModel)]="selectedYear"
        (ngModelChange)="loadBilling()">
        <option *ngFor="let y of years" [value]="y">{{ y }}</option>
      </select>
    </div>

    <!-- Month Dropdown -->
    <div class="flex-1 min-w-[140px] flex flex-col">
      <select 
        class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
        [(ngModel)]="selectedMonth"
        (ngModelChange)="loadBilling()">
        <option *ngFor="let m of months" [value]="m">{{ m }}</option>
      </select>
    </div>

    <div class="flex flex-wrap gap-4 items-center">

      <!-- Generate Billing -->
      <button 
        class="bg-blue-600 text-white font-semibold rounded-md px-5 py-2 shadow-sm hover:shadow-md hover:bg-blue-700 transition"
        (click)="generateBilling()">
        Generate Billing
      </button>

      <!-- Generate SOA
      <button 
        class="bg-teal-600 text-white font-semibold rounded-md px-5 py-2 shadow-sm hover:shadow-md hover:bg-teal-700 transition">
        Generate SOA
      </button> -->

      <!-- Print -->
      <!-- <button 
        class="bg-white border border-red-500 text-red-500 font-semibold rounded-md px-5 py-2 shadow-sm hover:shadow-md hover:bg-red-50 transition"
       >
        Print
      </button> -->

    </div>
  </div>
</div>

<!-- Owner Detailed Billing -->
<div class="overflow-x-auto p-4 border rounded-lg bg-gray-50 shadow-sm">
  <table class="min-w-full table-auto border-collapse">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-4 py-2 border">#</th>
        <th class="px-4 py-2 border">Bldng #</th>
        <th class="px-4 py-2 border">Unit #</th>
        <th class="px-4 py-2 border">Billing Month</th>
        <th class="px-4 py-2 border">Due Date</th>
        <th class="px-4 py-2 border text-right">Condo Dues</th>
        <th class="px-4 py-2 border text-right">Water Bill</th>
        <th class="px-4 py-2 border text-right">Overdue</th>
        <th class="px-4 py-2 border text-right">Penalty</th>
        <th class="px-4 py-2 border text-right">Total</th>
        <th class="px-4 py-2 border text-right">Paid</th>
        <th class="px-4 py-2 border text-right">Balance</th>
        <th class="px-4 py-2 border">Status</th>
      </tr>
    </thead>
    <tbody>
      <!-- Loading row -->
      <tr *ngIf="loading">
        <td colspan="13" class="text-center p-4">Loading...</td>
      </tr>

      <!-- Billing rows -->
      <tr *ngFor="let bill of billings; let i = index">
        <td class="border px-4 py-2 text-center">{{ i + 1 }}</td>
        <td class="border px-4 py-2">{{ bill.BuildingNumber }}</td>
        <td class="border px-4 py-2">{{ bill.UnitNumber }}</td>
        <td class="border px-4 py-2 text-center">{{ bill.BillingMonth }}</td>
        <td class="border px-4 py-2 text-center">{{ bill.DueDate | date:'yyyy-MM-dd' }}</td>
        <td class="border px-4 py-2 text-right">₱{{ bill.CondoDues | number:'1.2-2' }}</td>
        <td class="border px-4 py-2 text-right">₱{{ bill.WaterBill | number:'1.2-2' }}</td>
        <td class="border px-4 py-2 text-right">₱{{ bill.OverdueAmount | number:'1.2-2' }}</td>
        <td class="border px-4 py-2 text-right">₱{{ bill.Penalty | number:'1.2-2' }}</td>
        <td class="border px-4 py-2 text-right font-semibold">₱{{ bill.TotalAmount | number:'1.2-2' }}</td>
        <td class="border px-4 py-2 text-right">₱{{ bill.PaidAmount | number:'1.2-2' }}</td>
        <td class="border px-4 py-2 text-right text-red-600">₱{{ bill.Balance | number:'1.2-2' }}</td>
        <td class="border px-4 py-2 text-center">{{ bill.Status }}</td>
      </tr>

      <!-- No records -->
      <tr *ngIf="!loading && billings.length === 0">
        <td colspan="13" class="text-center p-4 text-gray-500">No billing records found.</td>
      </tr>
    </tbody>
  </table>

</div>